<?php
/**
 * 필수적인 데이타
 * $key_names 	: 데이타 필드명 리스트
 * $keys 		: 데이타 필드 키 리스트
 * $dataset 	: 데이타 리스트
 * 
 * 선택적인 데이타
 * $filename : 파일명
 * 
 */
// We change the headers of the page so that the browser will know what sort of file is dealing with. Also, we will tell the browser it has to treat the file as an attachment which cannot be cached.
// 
header("Content-type: application/octet-stream");
header("Content-Disposition: attachment; filename=" . ((isset($filename)) ? $filename : 'exceldata') . ".xls");
header("Pragma: no-cache");
header("Expires: 0");
?>
<table border='1'>
	<tr>
		<?foreach ($key_names as $key => $name):?>
		<td><?=$name;?></td>
		<?endforeach;?>
	</tr>
	<?foreach ($dataset as $key => $item):?>
	<tr>
		<?foreach ($keys as $key => $idx):?>
		<td><?=$item[$idx];?></td>
		<?endforeach;?>
	</tr>
	<?endforeach;?>
</table>